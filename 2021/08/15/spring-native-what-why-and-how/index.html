<!DOCTYPE html>
<html lang=zh>
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="keywords" content="">
  
    <link rel="icon" href="">
  
    
  <title>Spring Native: What, Why and How | 上下未形，何由考之？冥昭瞢暗，誰能極之？馮翼惟象，何以識之？</title>
  <meta name="description" content="">
  
<link rel="stylesheet" href="/style.css">

  
<link rel="stylesheet" href="/lib/jquery.fancybox.min.css">

  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <header>
  <div class="header-container">
    <a class='logo' href="/">
      <span>上下未形，何由考之？冥昭瞢暗，誰能極之？馮翼惟象，何以識之？</span>
    </a>
    <ul class="right-header">
      
        <li class="nav-item">
          
            <a href="/" class="item-link">首页</a>
          
        </li>
      
        <li class="nav-item">
          
            <a href="/about" class="item-link">关于</a>
          
        </li>
      
        <li class="nav-item">
          
            <a href="/archives" class="item-link">归档</a>
          
        </li>
      
        <li class="nav-item">
          
            <a href="/tags" class="item-link">标签</a>
          
        </li>
      
    </ul>
  </div>
</header>

  <main id='post'>
  <div class="content">
    <article>
      <section class="content markdown-body">
        <h1>
          Spring Native: What, Why and How
        </h1>
        <div class='post-meta'>
          <i class="fa fa-calendar"
            aria-hidden="true"></i> <time>
            2021/08/15</time>
          
          | <i class="fa fa-folder-open-o"
            aria-hidden="true"></i>
          
  <div class="article-category">
    <a class="article-category-link" href="/categories/Programming/">Programming</a>/ <a class="article-category-link" href="/categories/Programming/Java/">Java</a>
  </div>



          
          
          |
          
          <i class="fa fa-tags"
            aria-hidden="true"></i>
          
          
  <a href="/tags/#Programming" class='tag'>Programming</a>

  <a href="/tags/#Java" class='tag'>Java</a>


          
        </div>
        <h1 id="Spring-Native-What-Why-and-How"><a href="#Spring-Native-What-Why-and-How" class="headerlink" title="Spring Native: What, Why and How"></a>Spring Native: What, Why and How</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p><a target="_blank" rel="noopener" href="https://github.com/spring-projects-experimental/spring-native">Spring Native</a> makes sure we can compile Spring applications to a native executable. To get these native executables Spring Native uses the <a target="_blank" rel="noopener" href="https://www.graalvm.org/reference-manual/native-image/">GraalVM Native Image</a> compiler.</p>
<p>Compared to the Java Virtual Machine, native images can enable cheaper and more sustainable hosting for many types of workloads. These include microservices, function workloads, well suited to containers, and <a target="_blank" rel="noopener" href="https://kubernetes.io/">Kubernetes</a>.</p>
<p>Using native image provides key advantages, such as instant startup, instant peak performance, and reduced memory consumption.</p>
<p>There are also some drawbacks and trade-offs that the GraalVM native project expect to improve on over time. Building a native image is a heavy process that is slower than a regular application. A native image has fewer runtime optimizations after warmup. Finally, it is less mature than the JVM with some different behaviors.</p>
<p>The key differences between a regular JVM and this native image platform are:</p>
<ul>
<li>A <strong>static analysis</strong> of your application from the main entry point is performed at build time.</li>
<li>The unused parts are removed at build time.</li>
<li><strong>Configuration is required for reflection, resources, and dynamic proxies</strong>.</li>
<li><strong>Classpath is fixed at build time</strong>.</li>
<li><strong>No class lazy loading</strong>: everything shipped in the executables will be loaded in memory on startup.</li>
<li>Some code will run at build time.</li>
<li>There are some <a target="_blank" rel="noopener" href="https://www.graalvm.org/reference-manual/native-image/Limitations/">limitations</a> around some aspects of Java applications that are not fully supported.</li>
</ul>
<h2 id="What-are-GraalVM-Native-Images"><a href="#What-are-GraalVM-Native-Images" class="headerlink" title="What are GraalVM Native Images"></a>What are GraalVM Native Images</h2><p>Native Image is a technology to <strong>ahead-of-time compile (AOT)</strong> Java code to a standalone executable, called a native image. This executable includes the application classes, classes from its dependencies, runtime library classes, and statically linked native code from JDK.</p>
<h2 id="What-is-Spring-Native"><a href="#What-is-Spring-Native" class="headerlink" title="What is Spring Native"></a>What is Spring Native</h2><p>Like stated in the intro of this article, Spring Native is a set of tools and frameworks to make the Spring framework compatible with GraalVM Native Images.</p>
<h2 id="Advantages-for-native-images"><a href="#Advantages-for-native-images" class="headerlink" title="Advantages for native images"></a>Advantages for native images</h2><p>Here are some few advantages of native images:</p>
<h3 id="Faster-startup"><a href="#Faster-startup" class="headerlink" title="Faster startup"></a>Faster startup</h3><p>A native image will startup faster, but why can it start faster?</p>
<ul>
<li><strong>No class loading</strong>: All classes will already we loaded and even partially initiated during build time. This is made possible with the AOT compiler.</li>
<li><strong>No interpreted code</strong>: We don’t have to initialize an interpreter and interpret byte-code</li>
<li><strong>No JIT</strong>: We don’t have to spend any CPU resources to start a JIT compiler or use a JIT compiler</li>
<li><strong>Generating Image Heap during build</strong>: Because we can already partially <strong>initiate classes</strong> at build time, we can also run some <strong>initialization processes</strong> at build time. So when we startup we don’t have to execute that part anymore</li>
</ul>
<h3 id="Lower-memory-usage"><a href="#Lower-memory-usage" class="headerlink" title="Lower memory usage"></a>Lower memory usage</h3><p>The native image will have less memory usage which makes is more suitable for Docker Images, just to give an example. How does a native image archive this?</p>
<ul>
<li>No metadata for loaded classes</li>
<li>No profiling data for JIT</li>
<li>No Interpreter code</li>
</ul>
<h2 id="Disadvantages-for-native-images"><a href="#Disadvantages-for-native-images" class="headerlink" title="Disadvantages for native images"></a>Disadvantages for native images</h2><p>That all sounds good and way better than normal JVM applications. But there are of course also prices to pay when using native images.</p>
<h3 id="No-Java-agents-JMX-JVMTI-Java-Flight-Recorder-support"><a href="#No-Java-agents-JMX-JVMTI-Java-Flight-Recorder-support" class="headerlink" title="No Java agents, JMX, JVMTI, Java Flight Recorder support"></a>No Java agents, JMX, JVMTI, Java Flight Recorder support</h3><p>Some of these features are really handy to manage, test and control your JVM applications. Because the native images does not live in a JVM container these features are not available.</p>
<h3 id="Reflection-requires-extra-config"><a href="#Reflection-requires-extra-config" class="headerlink" title="Reflection requires extra config"></a>Reflection requires extra config</h3><p>Reflection is widely used in a lot of frameworks so those frameworks need to do extra configuration and work to support native images. That is why Spring created the Spring Native project.</p>
<h3 id="No-dumps"><a href="#No-dumps" class="headerlink" title="No dumps"></a>No dumps</h3><p>You will not be able to able to use thread and heap dumps. There are ways to fetch some information about threads by using Linux Kernel features.</p>
<h3 id="Limited-Logging"><a href="#Limited-Logging" class="headerlink" title="Limited Logging"></a>Limited Logging</h3><ul>
<li>Logback is supported, but not configuration with <code>logback.xml</code> so please configure it with <code>application.properties</code> or <code>application.yml</code> for now, see <a target="_blank" rel="noopener" href="https://github.com/spring-projects-experimental/spring-native/issues/625">Add support for logback.xml configuration file</a> for more details.</li>
<li>Log4j2 is not supported yet, see <a target="_blank" rel="noopener" href="https://github.com/spring-projects-experimental/spring-native/issues/115">Add support for Log4j2</a>.</li>
</ul>
<h2 id="When-do-we-best-to-use-Spring-Native"><a href="#When-do-we-best-to-use-Spring-Native" class="headerlink" title="When do we best to use Spring Native"></a>When do we best to use Spring Native</h2><p>Spring Native images is the best suited when you are building CLI tools or create some serverless functions. This all has to do with the short live span of the application and the faster startup time. <strong>Spring Cloud Functions</strong> fit really good with native images.</p>
<h2 id="Building-an-example-Native-Image"><a href="#Building-an-example-Native-Image" class="headerlink" title="Building an example Native Image"></a>Building an example Native Image</h2><p>The easiest way to start with Spring Native is probably to go to <a target="_blank" rel="noopener" href="https://start.spring.io/">Spring Initializer Site</a>, add the dependencies <strong>Spring Reactive Web</strong> and <strong>Spring Native [Experimental]</strong>, and read the <a target="_blank" rel="noopener" href="https://docs.spring.io/spring-native/docs/current/reference/htmlsingle">reference documentation</a>. Make sure to configure properly the <a target="_blank" rel="noopener" href="https://docs.spring.io/spring-native/docs/current/reference/htmlsingle/#spring-aot">Spring AOT Maven and Gradle plugins</a> that are mandatory to get proper native support for your Spring application.</p>
<p>Make sure the following are installed: Java 11, Maven&#x2F;Gradle, Docker, and <a target="_blank" rel="noopener" href="https://www.graalvm.org/reference-manual/native-image/">GraalVM native-image</a> compiler.</p>
<h3 id="Update-pom-xml"><a href="#Update-pom-xml" class="headerlink" title="Update pom.xml"></a>Update pom.xml</h3><p>Add <strong>Spring Native [Experimental]</strong> dependency to the <strong>pom.xml</strong>:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.experimental<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-native<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-native.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Add <strong>spring-aot-maven-plugin</strong> to the <strong>pom.xml</strong>:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.experimental<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-native.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>test-generate<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">goal</span>&gt;</span>test-generate<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>generate<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">goal</span>&gt;</span>generate<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>This plugin is used to compile your Spring application code to make it ready for native execution. This plugin will also add all the configuration that is needed to handle the Reflection that Spring uses.</p>
<h3 id="Spring-AOT"><a href="#Spring-AOT" class="headerlink" title="Spring AOT"></a>Spring AOT</h3><p>Spring AOT (Ahead-of-Time) aims at improving compatibility and footprint of native images for Spring Native applications. To achieve that, this projects ships Maven and Gradle build plugins that generate and compile a separate set of Java sources to be packaged with your Spring Boot application. By looking at your application classpath and configuration, Spring AOT brings some of the configuration processing at build time and streamlines the native image compilation process.</p>
<p>Maven goals <strong>spring-aot:generate</strong> (<strong>process-test-classes</strong> phase) and <strong>spring-aot:test-generate</strong> (<strong>prepare-package</strong> phase) are automatically invoked in the Maven lifecycle when using the <code>mvn verify</code> or <code>mvn package</code> commands.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mvn -D skipTests=<span class="literal">true</span> package spring-aot:generate</span><br><span class="line">Total time:  01:25 min</span><br></pre></td></tr></table></figure>

<h3 id="Add-endpoint"><a href="#Add-endpoint" class="headerlink" title="Add endpoint"></a>Add endpoint</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> RouterFunction&lt;ServerResponse&gt; <span class="title function_">routes</span><span class="params">()</span> &#123;</span><br><span class="line">   <span class="keyword">return</span> RouterFunctions.route()</span><br><span class="line">      .GET(<span class="string">&quot;/&quot;</span>, request -&gt; ServerResponse.ok().body(Mono.just(<span class="string">&quot;Hello World!\n&quot;</span>), String.class))</span><br><span class="line">      .build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Verification-Endpoint"><a href="#Verification-Endpoint" class="headerlink" title="Verification Endpoint"></a>Verification Endpoint</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mvn spring-boot:run</span></span><br><span class="line">Started SpringBootNativeApplication <span class="keyword">in</span> 6.65 seconds (JVM running <span class="keyword">for</span> 7.325)</span><br><span class="line"></span><br><span class="line"><span class="comment"># curl -iSS http://localhost:8080</span></span><br><span class="line"><span class="comment"># curl -iSS --http2 http://localhost:8080</span></span><br><span class="line"><span class="comment"># curl -iSS --http2-prior-knowledge http://localhost:8080</span></span><br></pre></td></tr></table></figure>

<h3 id="Building-the-image"><a href="#Building-the-image" class="headerlink" title="Building the image"></a>Building the image</h3><p>Now we need to use maven to build the docker image. Spring boot already has support to build docker images with it’s plugin.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ java -version</span><br><span class="line">java version <span class="string">&quot;11.0.12&quot;</span> 2021-07-20 LTS</span><br><span class="line">Java(TM) SE Runtime Environment GraalVM EE 21.2.0 (build 11.0.12+8-LTS-jvmci-21.2-b06)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM GraalVM EE 21.2.0 (build 11.0.12+8-LTS-jvmci-21.2-b06, mixed mode, sharing)</span><br><span class="line"></span><br><span class="line">$ gradle tasks</span><br><span class="line"></span><br><span class="line">$ gradle bootBuildImage -x <span class="built_in">test</span></span><br><span class="line">Successfully built image <span class="string">&#x27;docker.io/library/spring-boot-native:0.0.1-SNAPSHOT&#x27;</span></span><br><span class="line">BUILD SUCCESSFUL <span class="keyword">in</span> 8m 5s</span><br><span class="line"></span><br><span class="line"><span class="comment"># docker images</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># docker run --rm --name spring-native-example -p 8080:8080 docker.io/library/spring-boot-native:0.0.1-SNAPSHOT</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ mvn -U -D skipTests=<span class="literal">true</span> package spring-boot:build-image</span><br><span class="line">Successfully built image <span class="string">&#x27;docker.io/library/spring-boot-native:0.0.1-SNAPSHOT&#x27;</span></span><br><span class="line">Total time:  06:43 min</span><br><span class="line"></span><br><span class="line"><span class="comment"># docker images</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># docker run --rm --name spring-native-example -p 8080:8080 docker.io/library/spring-boot-native:0.0.1-SNAPSHOT</span></span><br></pre></td></tr></table></figure>

<h3 id="Verification-Native-Image"><a href="#Verification-Native-Image" class="headerlink" title="Verification Native Image"></a>Verification Native Image</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ curl -iSS http://localhost:8080</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Content-Type: text/plain;charset=UTF-8</span><br><span class="line">Content-Length: 13</span><br><span class="line"></span><br><span class="line">Hello World!</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ curl -iSS --http2 http://localhost:8080</span><br><span class="line">HTTP/1.1 101 Switching Protocols</span><br><span class="line">connection: upgrade</span><br><span class="line">upgrade: h2c</span><br><span class="line"></span><br><span class="line">HTTP/2 200</span><br><span class="line">content-type: text/plain;charset=UTF-8</span><br><span class="line">content-length: 13</span><br><span class="line"></span><br><span class="line">Hello World!</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ curl -iSS --http2-prior-knowledge http://localhost:8080</span><br><span class="line">HTTP/2 200</span><br><span class="line">content-type: text/plain;charset=UTF-8</span><br><span class="line">content-length: 13</span><br><span class="line"></span><br><span class="line">Hello World!</span><br></pre></td></tr></table></figure>

<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>We went a bit over the theory what native images are and how Spring Native fits into the equation. The example application shows that the native image boots up way faster. Currently Spring Native is still experimental and in beta, but it looks real promising for serverless architectures.</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://start.spring.io/">Spring Initializer Site</a></li>
<li><a target="_blank" rel="noopener" href="https://www.graalvm.org/reference-manual/native-image/">GraalVM Native Image</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/spring-projects-experimental/spring-native/">Spring Native</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-native/docs/current/reference/htmlsingle/">Spring Native reference documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.gradle.org/">Official Gradle documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/current/gradle-plugin/reference/html/">Spring Boot Gradle Plugin Reference Guide</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/">Spring Web</a></li>
<li><a target="_blank" rel="noopener" href="https://spring.io/guides/gs/rest-service/">Building a RESTful Web Service</a></li>
<li><a target="_blank" rel="noopener" href="https://spring.io/guides/gs/serving-web-content/">Serving Web Content with Spring MVC</a></li>
<li><a target="_blank" rel="noopener" href="https://spring.io/guides/tutorials/bookmarks/">Building REST services with Spring</a></li>
</ul>

      </section>
    </article>
    
    
  </div>
  <aside>
    
    <div class="toc-container">
      <h1>
        catalog
      </h1>
      <div class="content">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Spring-Native-What-Why-and-How"><span class="toc-number">1.</span> <span class="toc-text">Spring Native: What, Why and How</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#What-are-GraalVM-Native-Images"><span class="toc-number">1.2.</span> <span class="toc-text">What are GraalVM Native Images</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#What-is-Spring-Native"><span class="toc-number">1.3.</span> <span class="toc-text">What is Spring Native</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Advantages-for-native-images"><span class="toc-number">1.4.</span> <span class="toc-text">Advantages for native images</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Faster-startup"><span class="toc-number">1.4.1.</span> <span class="toc-text">Faster startup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lower-memory-usage"><span class="toc-number">1.4.2.</span> <span class="toc-text">Lower memory usage</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Disadvantages-for-native-images"><span class="toc-number">1.5.</span> <span class="toc-text">Disadvantages for native images</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#No-Java-agents-JMX-JVMTI-Java-Flight-Recorder-support"><span class="toc-number">1.5.1.</span> <span class="toc-text">No Java agents, JMX, JVMTI, Java Flight Recorder support</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Reflection-requires-extra-config"><span class="toc-number">1.5.2.</span> <span class="toc-text">Reflection requires extra config</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#No-dumps"><span class="toc-number">1.5.3.</span> <span class="toc-text">No dumps</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Limited-Logging"><span class="toc-number">1.5.4.</span> <span class="toc-text">Limited Logging</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#When-do-we-best-to-use-Spring-Native"><span class="toc-number">1.6.</span> <span class="toc-text">When do we best to use Spring Native</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Building-an-example-Native-Image"><span class="toc-number">1.7.</span> <span class="toc-text">Building an example Native Image</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Update-pom-xml"><span class="toc-number">1.7.1.</span> <span class="toc-text">Update pom.xml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spring-AOT"><span class="toc-number">1.7.2.</span> <span class="toc-text">Spring AOT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Add-endpoint"><span class="toc-number">1.7.3.</span> <span class="toc-text">Add endpoint</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Verification-Endpoint"><span class="toc-number">1.7.4.</span> <span class="toc-text">Verification Endpoint</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Building-the-image"><span class="toc-number">1.7.5.</span> <span class="toc-text">Building the image</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Verification-Native-Image"><span class="toc-number">1.7.6.</span> <span class="toc-text">Verification Native Image</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conclusion"><span class="toc-number">1.8.</span> <span class="toc-text">Conclusion</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">1.9.</span> <span class="toc-text">Reference</span></a></li></ol></li></ol>
      </div>
    </div>
    
  </aside>
</main>



  <footer>
  <div class="copyright">
    <div>
      &copy;
      2024 | Powered by <a href="https://hexo.io"
        target="_blank">Hexo</a>&nbsp
    </div>
    <div>
      Theme by <a href="https://github.com/lewis-geek/hexo-theme-Aath"
        target="_blank">Aath</a>
    </div>
  </div>
</footer>


<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>

<script src="/lib/ScrollMagic.min.js"></script>


<script src="/lib/lodash.min.js"></script>

<script>
  document.body.addEventListener('touchstart', function () { });

  // 文章图片预览
  $("article img").each(function () {
    var strA = "<a data-fancybox='gallery' href='" + this.src + "'></a>";
    $(this).wrapAll(strA);
  });

  // 目录联动
  let tocLinkList = $('.toc-link')

  let controller = new ScrollMagic.Controller({
    globalSceneOptions: {
      triggerHook: 0.01
    }
  })

  tocLinkList.each(function (index, elem) {
    let href = $(this).attr("href");
    let nextHref = tocLinkList.eq(index + 1).attr("href");
    let height = href && nextHref ? $(nextHref).offset().top - $(href).offset().top : 0

    new ScrollMagic.Scene({ triggerElement: href })
      .duration(height)
      .setClassToggle(".toc [href='" + href + "']", 'active')
      .addTo(controller)
  })

  window.addEventListener('load', function () {
    // 目录联动 图片加载完成后从新计算
    tocLinkList.each(function (index, elem) {
      let href = $(this).attr("href");
      let nextHref = tocLinkList.eq(index + 1).attr("href");
      let height = href && nextHref ? $(nextHref).offset().top - $(href).offset().top : 0

      new ScrollMagic.Scene({ triggerElement: href })
        .duration(height)
        .setClassToggle(".toc [href='" + href + "']", 'active')
        .addTo(controller)
    })
  })
</script>

<script src="/lib/jquery.fancybox.min.js"></script>



</body>
</html>
